---
title: "Analysis.rmd"
author: "Ben, Emma, and Felix"
date: "2024-10-03"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, janitor, urbnmapr)

# Do we need this?
renv::snapshot

```

# Average Annual Out of Pocket Healthcare Cost and COVID-19 Cases by County

## Introduction



```{r downloading datasets}

avghealthcarecost2022<-read_csv("data/policymaptest.csv")
avghealthcarecost2022
rate2021<-read_csv("data/covidrate2021.csv")
rate2021

```


```{r creating dataset}

covid_healthcare_costs <- left_join(avghealthcarecost2022, rate2021, by=c("GeoID", "Geography Name", "Sits in State")) %>% 
  row_to_names(row_number = 1) %>% 
  clean_names() %>% 
  rename(
    county = geo_id_name,
    state = sitsin_state,
    county_fips = geo_id,
    avg_healthcarecost = totslf_avg,
    year = time_frame,
    avg_covidcases = pc_av7dy_2wk_cases,
    week_start = time_frame_2) %>% 
  select("county","state", "county_fips", "avg_healthcarecost", "year", "avg_covidcases", "week_start") %>% 
  drop_na() %>% 
  mutate(avg_healthcarecost = as.numeric(avg_healthcarecost),
         avg_covidcases = as.numeric(avg_covidcases))
  
covid_healthcare_costs

```

## Preliminary Data Analysis



```{r }
summary(covid_healthcare_costs$avg_healthcarecost)
summary(covid_healthcare_costs$avg_covidcases)


```

## Map



```{r map}

# install.packages("devtools")
# devtools::install_github("UrbanInstitute/urbnmapr")
# library(urbnmapr)



us_covid_healthcare_costs <- left_join(covid_healthcare_costs, counties, by = "county_fips") 

us_covid_healthcare_costs %>%
  ggplot(aes(long, lat, group = group, fill = avg_healthcarecost)) +
  geom_polygon(color = NA) +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  theme_void() +
  labs(fill = "")

us_covid_healthcare_costs %>%
  ggplot(aes(long, lat, group = group, fill = avg_covidcases)) +
  geom_polygon(color = NA) +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  theme_void() +
  labs(fill = "")

```
















