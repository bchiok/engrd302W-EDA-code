#devtools::install_github("UrbanInstitute/urbnmapr")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
state_keys <- tibble(state = state.name, ab = state.abb) %>%
rename(state_name = state)
state_keys
library(tidyverse, janitor, urbnmapr)
summary(us_covid_healthcare_costs$avg_covidcases)
standard1<-us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(annualcovidcases-mediancases)*100/mediancasesstate2021) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_cost_2022, na.rm=T)) %>%
mutate(newcosts=(avg_cost_2022-mediancostsstate)*100/mediancostsstate) %>%
group_by(state) %>%
mutate(mediancasesstate2022=median(annualcases_2022, na.rm=T)) %>%
mutate(newcases2022=(annualcases_2022-mediancasesstate2022)*100/mediancasesstate2022)
us_covid_healthcare_costs
summary(us_covid_healthcare_costs$avg_covidcases)
standard1<-us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_cost_2022, na.rm=T)) %>%
mutate(newcosts=(avg_cost_2022-mediancostsstate)*100/mediancostsstate)
us_covid_healthcare_costs
summary(us_covid_healthcare_costs$avg_covidcases)
standard1<-us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
# summary(covid_healthcare_costs$avg_covidcases)
# summary(covid_healthcare_costs$avg_healthcarecost)
#
# IQR(covid_healthcare_costs$avg_covidcases, na.rm=T)
# Q1=quantile(covid_healthcare_costs$avg_covidcases, .25, na.rm=T)
# Q3=quantile(covid_healthcare_costs$avg_covidcases, .75, na.rm=T)
# IQR1=Q3-Q1
# Q1cost=quantile(covid_healthcare_costs$avg_healthcarecost, .25, na.rm=T)
# Q3cost=quantile(covid_healthcare_costs$avg_healthcarecost, .75, na.rm=T)
# IQR2=Q3cost-Q1cost
#
# covid_healthcare_costs_cleaned <- covid_healthcare_costs %>%
#   mutate(is_outlier=avg_covidcases<(Q1-1.5*IQR1) | avg_covidcases>(Q3+1.5*IQR1)|avg_healthcarecost<(Q1cost-1.5*IQR2) | avg_healthcarecost>(Q3cost+1.5*IQR2)) %>%
#   filter(!is_outlier)
#
# summary(covid_healthcare_costs_cleaned$avg_healthcarecost)
# summary(covid_healthcare_costs_cleaned$avg_covidcases)
standard1<-us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
# summary(covid_healthcare_costs$avg_covidcases)
# summary(covid_healthcare_costs$avg_healthcarecost)
#
# IQR(covid_healthcare_costs$avg_covidcases, na.rm=T)
# Q1=quantile(covid_healthcare_costs$avg_covidcases, .25, na.rm=T)
# Q3=quantile(covid_healthcare_costs$avg_covidcases, .75, na.rm=T)
# IQR1=Q3-Q1
# Q1cost=quantile(covid_healthcare_costs$avg_healthcarecost, .25, na.rm=T)
# Q3cost=quantile(covid_healthcare_costs$avg_healthcarecost, .75, na.rm=T)
# IQR2=Q3cost-Q1cost
#
# covid_healthcare_costs_cleaned <- covid_healthcare_costs %>%
#   mutate(is_outlier=avg_covidcases<(Q1-1.5*IQR1) | avg_covidcases>(Q3+1.5*IQR1)|avg_healthcarecost<(Q1cost-1.5*IQR2) | avg_healthcarecost>(Q3cost+1.5*IQR2)) %>%
#   filter(!is_outlier)
#
# summary(covid_healthcare_costs_cleaned$avg_healthcarecost)
# summary(covid_healthcare_costs_cleaned$avg_covidcases)
us_covid_healthcare_costs
summary(standard1$newcases)
summary(standard1$newcosts)
standard1<-us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T))
us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T))
us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T))
us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases)
standard1<- us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
# summary(covid_healthcare_costs$avg_covidcases)
# summary(covid_healthcare_costs$avg_healthcarecost)
#
# IQR(covid_healthcare_costs$avg_covidcases, na.rm=T)
# Q1=quantile(covid_healthcare_costs$avg_covidcases, .25, na.rm=T)
# Q3=quantile(covid_healthcare_costs$avg_covidcases, .75, na.rm=T)
# IQR1=Q3-Q1
# Q1cost=quantile(covid_healthcare_costs$avg_healthcarecost, .25, na.rm=T)
# Q3cost=quantile(covid_healthcare_costs$avg_healthcarecost, .75, na.rm=T)
# IQR2=Q3cost-Q1cost
#
# covid_healthcare_costs_cleaned <- covid_healthcare_costs %>%
#   mutate(is_outlier=avg_covidcases<(Q1-1.5*IQR1) | avg_covidcases>(Q3+1.5*IQR1)|avg_healthcarecost<(Q1cost-1.5*IQR2) | avg_healthcarecost>(Q3cost+1.5*IQR2)) %>%
#   filter(!is_outlier)
#
# summary(covid_healthcare_costs_cleaned$avg_healthcarecost)
# summary(covid_healthcare_costs_cleaned$avg_covidcases)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
standard1<- us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
boxplot(standard1$newcosts)
Q1case1=quantile(standard1$newcases, .25, na.rm=T)
Q3case1=quantile(standard1$newcases, .75, na.rm=T)
IQR4=Q3case1-Q1case1
Q1cost1=quantile(standard1$newcosts, .25, na.rm=T)
Q3cost1=quantile(standard1$newcosts, .75, na.rm=T)
IQR5=Q3cost1-Q1cost1
standard_costs_cleaned <- standard1 %>%
mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
newcases>(Q3case1+1.5*IQR4)|
newcosts<(Q1cost1-1.5*IQR5)|
newcosts>(Q3cost1+1.5*IQR5)) %>%
filter(!is_outlier)
summary(standard_costs_cleaned$newcases)
summary(standard_costs_cleaned$newcosts)
boxplot(standard_costs_cleaned$newcases)
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned <- standard1 %>%
mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
newcases>(Q3case1+1.5*IQR4)|
newcosts<(Q1cost1-1.5*IQR5)|
newcosts>(Q3cost1+1.5*IQR5)) %>%
filter(!is_outlier) %>%
filter(state=="Georgia")
summary(standard_costs_cleaned$newcases)
summary(standard_costs_cleaned$newcosts)
boxplot(standard_costs_cleaned$newcases)
standard1 %>%
mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
newcases>(Q3case1+1.5*IQR4)|
newcosts<(Q1cost1-1.5*IQR5)|
newcosts>(Q3cost1+1.5*IQR5)) %>%
filter(!is_outlier)
standard_costs_cleaned <- standard1 %>%
mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
newcases>(Q3case1+1.5*IQR4)|
newcosts<(Q1cost1-1.5*IQR5)|
newcosts>(Q3cost1+1.5*IQR5)) %>%
filter(!is_outlier) %>%
filter(state=="GA")
summary(standard_costs_cleaned$newcases)
summary(standard_costs_cleaned$newcosts)
boxplot(standard_costs_cleaned$newcases)
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard1<- us_covid_healthcare_costs %>%
group_by(state) %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
group_by(state) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
boxplot(standard1$newcosts)
Q1case1=quantile(standard1$newcases, .25, na.rm=T)
Q3case1=quantile(standard1$newcases, .75, na.rm=T)
IQR4=Q3case1-Q1case1
Q1cost1=quantile(standard1$newcosts, .25, na.rm=T)
Q3cost1=quantile(standard1$newcosts, .75, na.rm=T)
IQR5=Q3cost1-Q1cost1
standard_costs_cleaned <- standard1 %>%
mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
newcases>(Q3case1+1.5*IQR4)|
newcosts<(Q1cost1-1.5*IQR5)|
newcosts>(Q3cost1+1.5*IQR5)) %>%
filter(!is_outlier)
summary(standard_costs_cleaned$newcases)
summary(standard_costs_cleaned$newcosts)
boxplot(standard_costs_cleaned$newcases)
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard_costs_cleaned %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
map_counties<-counties %>%
mutate(fips=as.numeric(county_fips))
map_costs_cases<-left_join(covid_costs, map_counties, by = c("fips")) %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022))
map_costs_cases %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
map_costs_cases
map_counties<-counties %>%
mutate(fips=as.numeric(county_fips))
map_costs_cases<-left_join(covid_costs, map_counties, by = c("fips")) %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022))
map_costs_cases %>%
filter(state=="Georgia") %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
map_costs_cases %>%
filter(state=="Georgia") %>%
ggplot(aes(long, lat, group = group, fill = annualcases_2021)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
map_costs_cases %>%
filter(state=="Georgia") %>%
ggplot(aes(long, lat, group = group, fill = annualcases_2022)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
# ## If you want to use new data, the dataset is called covid_costs - Emma
us_covid_healthcare_costs <- left_join(covid_healthcare_costs, counties, by = c("county_fips"))
us_covid_healthcare_costs %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = avg_healthcarecost)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
us_covid_healthcare_costs %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = avg_covidcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T))
standard1<- us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
standard1<- us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
boxplot(standard1$newcosts)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
standard1<- us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
#
#
#
# Q1case1=quantile(standard1$newcases, .25, na.rm=T)
# Q3case1=quantile(standard1$newcases, .75, na.rm=T)
# IQR4=Q3case1-Q1case1
# Q1cost1=quantile(standard1$newcosts, .25, na.rm=T)
# Q3cost1=quantile(standard1$newcosts, .75, na.rm=T)
# IQR5=Q3cost1-Q1cost1
#
# standard_costs_cleaned <- standard1 %>%
#   mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
#            newcases>(Q3case1+1.5*IQR4)|
#            newcosts<(Q1cost1-1.5*IQR5)|
#            newcosts>(Q3cost1+1.5*IQR5)) %>%
#   filter(!is_outlier)
#
# summary(standard_costs_cleaned$newcases)
# summary(standard_costs_cleaned$newcosts)
#
# boxplot(standard_costs_cleaned$newcases)
standard1 %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard1 %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard1 %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
# standard_costs_cleaned %>%
#     ggplot(aes(long, lat, group = group, fill = newcases)) +
#   geom_polygon(color=NA) +
#   scale_fill_gradientn(colors=rev(rainbow(7)))+
#   coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
#   theme_void() +
#   labs(fill = "")
#
# standard_costs_cleaned %>%
#     ggplot(aes(long, lat, group = group, fill = newcosts)) +
#   geom_polygon(color=NA) +
#   scale_fill_gradientn(colors=rev(rainbow(7)))+
#   coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
#   theme_void() +
#   labs(fill = "")
#install.packages("tidyverse")
#install.packages("janitor")
#install.packages("pacman")
#install.packages("devtools")
#library(devtools)
#devtools::install_github("UrbanInstitute/urbnmapr")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
library(tidyverse, janitor, urbnmapr)
avghealthcare_2022 <- read.csv("./data/healthcarecosts2022.csv") %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
filter(sitsin_state == "GA") %>%
rename(county = geo_id_name,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(geo_id),
avg_cost_2022=as.numeric(avg_cost_2022)) %>%
select("county", "fips", "avg_cost_2022")
head(avghealthcare_2022)
county_pop <- read.csv("./data/population.csv") %>%
clean_names() %>%
filter(stname == "Georgia" & ctyname != "Georgia") %>%
mutate(county = sprintf("%03d", county)) %>%
unite(col = "fips", state, county, sep = "") %>%
mutate(county = str_remove(ctyname, " County"),
fips = as.numeric(fips)) %>%
select("fips", "county", "popestimate2021", "popestimate2022")
head(county_pop)
covidcases2021_new <- read.csv("./data/us-counties-2021.csv") %>%
filter(state == "Georgia" & county != "Unknown") %>%
select("date", "geoid", "county", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(fips = as.numeric(str_remove(geoid, "USA-"))) %>%
select(-"geoid")
head(covidcases2021_new)
covidcases2022_new <- read.csv("./data/us-counties-2022.csv") %>%
filter(state == "Georgia" & county != "Unknown") %>%
select("date", "geoid", "county", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(fips = as.numeric(str_remove(geoid, "USA-"))) %>%
select(-"geoid")
head(covidcases2022_new)
covid_cases_new <- covidcases2021_new %>%
left_join(covidcases2022_new, by = c("county", "fips"))
covid_pop <- covid_cases_new %>%
left_join(county_pop, by = c("county", "fips")) %>%
rowwise() %>%
mutate(avg_daily_cases_2021 = sum(c_across(starts_with("2021")), na.rm = T) / 365,
avg_daily_cases_2022 = sum(c_across(starts_with("2022")), na.rm = T) / 365) %>%
mutate(cases_per_100k_2021 = (avg_daily_cases_2021/popestimate2021)*100000,
cases_per_100k_2022 = (avg_daily_cases_2022/popestimate2022)*100000) %>%
select("county", "fips", "avg_daily_cases_2021", "avg_daily_cases_2022", "popestimate2021", "popestimate2022", "cases_per_100k_2021", "cases_per_100k_2022")
head(covid_pop)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"),
rank2022case=rank(-cases_per_100k_2022, ties.method="first"),
rank2022cost=rank(-avg_cost_2022, ties.method="first"))
head(covid_costs)
summary(covid_costs$rank2021case)
summary(covid_costs$avg_cost_2022)
summary(covid_costs$cases_per_100k_2021)
summary(covid_costs$cases_per_100k_2022)
