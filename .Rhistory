#install.packages("janitor")
#install.packages("pacman")
#install.packages("devtools")
#library(devtools)
#devtools::install_github("UrbanInstitute/urbnmapr")
# # Possibly Remove
# rate2021<-read.csv("data/covidrate2021.csv")
# head(rate2021)
# install.packages("stringr") #code randomly stopped working so i had to install this
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
library(tidyverse, janitor, urbnmapr)
library(stringr) #see above comment
summary(covid_healthcarecosts$avg_cost_2022)
hist(covid_healthcarecosts$avg_cost_2022)
summary(covid_healthcarecosts$cases_per_100k_2021)
hist(covid_healthcarecosts$cases_per_100k_2021)
summary(covid_healthcarecosts$cases_per_100k_2022)
hist(covid_healthcarecosts$cases_per_100k_2022)
summary(covid_healthcarecosts$avg_cost_2022)
hist(covid_healthcarecosts$avg_cost_2022)
summary(covid_healthcarecosts$cases_per_100k_2021)
hist(covid_healthcarecosts$cases_per_100k_2021)
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram() +
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram()
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram() +
labs(title = "Distribution of Average Annual Out of Pocket Healthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5)) +
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram() +
labs(title = "Distribution of Average Annual Out of Pocket Healthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black") +
labs(title = "Distribution of Average Annual Out of Pocket Healthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 5) +
labs(title = "Distribution of Average Annual Out of Pocket Healthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 10) +
labs(title = "Distribution of Average Annual Out of Pocket Healthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average Annual Out of Pocket Healthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average Annual Out of Pocket \nHealthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average New COVID-19 Cases per Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 10) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average Annual Out of Pocket \nHealthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average Annual Out of Pocket \nHealthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust=1, face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$avg_cost_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = avg_cost_2022)) +
geom_histogram(fill = "white", color = "black", bins = 8) +
labs(title = "Distribution of Average Annual Out of Pocket \nHealthcare Costs per Person",
subtitle = "Georgia, USA",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text( face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
scale_y_continuous(expand=expansion(mult=c(0,0.02)), breaks = seq(0, 3, 0.5), limits = c(0, 3)) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
scale_x_continuous(expand=expansion(mult=c(0,10)), breaks = seq(0, 3, 0.5), limits = c(0, 150)) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
scale_x_continuous(expand=expansion(mult=c(0,130)), breaks = seq(0, 10, 10), limits = c(0, 130)) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
scale_x_continuous(expand=expansion( breaks = seq(0, 10, 10), limits = c(0, 130)) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2022)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2022)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2022",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 20 +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 20) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 15) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
summary(covid_healthcarecosts$cases_per_100k_2021)
ggplot(data = covid_healthcarecosts, mapping = aes(x = cases_per_100k_2021)) +
geom_histogram(fill = "white", color = "black", bins = 20) +
labs(title = "Distribution of Average New COVID-19 Cases \nper Day per 100,000 People",
subtitle = "Georgia, USA - 2021",
x = "",
y = "Number of Counties") +
theme_minimal() +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold", size = 12),  # Larger y-axis labels
axis.title = element_text(face = "bold", size = 14),  # Larger axis titles
panel.grid.major = element_line(color = "lightgray"),  # Add light gray gridlines
panel.background = element_rect(fill = "aliceblue"),  # Add light blue background
plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
View(mapcovidcases)
maprankcovidcases <- mapcovidcases %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"),
rank2022case=rank(-cases_per_100k_2022, ties.method="first"),
rank2022cost=rank(-avg_cost_2022, ties.method="first")) %>%
select(-c("avg_cost_2022", "avg_daily_cases_2021", "avg_daily_cases_2022", "popestimate2021", "popestimate2022", "cases_per_100k_2021", "cases_per_100k_2022"))
head(maprankcovidcases)
maprankcovidcases <- mapcovidcases %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"),
rank2022case=rank(-cases_per_100k_2022, ties.method="first"),
rank2022cost=rank(-avg_cost_2022, ties.method="first")) %>%
select(-c("avg_cost_2022", "avg_daily_cases_2021", "avg_daily_cases_2022", "popestimate2021", "popestimate2022", "cases_per_100k_2021", "cases_per_100k_2022"))
head(maprankcovidcases)
maprankcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2021case)) +
geom_polygon() +
scale_fill_gradient(low="red", high="yellow")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2021 County rank of Average Cases per 100k per Day")
maprankcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2022case)) +
geom_polygon() +
scale_fill_gradient(low="red", high="yellow")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2022 County rank of Average Cases per 100k per Day")
maprankcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = rank2022cost)) +
geom_polygon(color=NA) +
scale_fill_gradient(low="red", high="yellow")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2022 County rank of Annual Out of Pocket Healthcare Cost")
maprankcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2021case)) +
geom_polygon() +
scale_fill_gradient(low="red", high="yellow")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2021 County rank of Average Cases per 100k per Day")
maprankcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2022case)) +
geom_polygon() +
scale_fill_gradient(low="red", high="yellow")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2022 County rank of Average Cases per 100k per Day")
maprankcovidcases %>%
# mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = rank2022cost)) +
geom_polygon(color=NA) +
scale_fill_gradient(low="red", high="yellow")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2022 County rank of Annual Out of Pocket Healthcare Cost")
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_healthcarecosts, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradient(low="yellow", high="red")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2021 Average cases per 100k per day")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradient(low="yellow", high="red")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2022 Average cases per 100k per day")
mapcovidcases %>%
# mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon(color=NA) +
scale_fill_gradient(low="yellow", high="red")+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "2022 Average Annual out of pocket healthcare costs (USD$)")
# Variable  <- c("county","fips","average annual healthcare cost", "average daily cases", "population estimate", "cases per 100K", "2021 case rank", "2022 case rank", "2022 cost rank")
# Definition <- c("county data was collected in", "unique code given to each count in the US", "out of pocket cost per person in 2022 measured in US dollars", "average daily new COVID-19 cases per year", "estimated population per year", "average daily new COVID-19 cases per year per 100,000 people", "rank of each county with one being the highest cases per 100k in 2021", "rank of each county with one being the highest cases per 100k in 2022", "rank of each county with one being the highest out of pocket healthcare cost in 2022")
# d <- data.frame(Variable,Definition)
# knitr::kable(d)
Variable  <- c("county","fips","average annual healthcare cost", "average daily cases", "population estimate", "cases per 100K")
Definition <- c("county data was collected in", "unique code given to each count in the US", "out of pocket cost per person in 2022 measured in US dollars", "average daily new COVID-19 cases per year", "estimated population per year", "average daily new COVID-19 cases per year per 100,000 people")
d <- data.frame(Variable,Definition)
knitr::kable(d)
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_healthcarecosts, counties1, by=c("fips"))
counties1 <-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases <- left_join(covid_healthcarecosts, counties1, by=c("fips"))
counties1 <-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases <- left_join(covid_healthcarecosts, counties1, by=c("fips"))
cost_sum <- summary(covid_healthcarecosts$avg_cost_2022)
cost_sum
print(cost_sum)
print(cost_sum$mean)
print(cost_sum[2])
print(cost_sum[5])
print(cost_sum[4])
print(cost_sum[3])
print(cost_sum[1])
print(cost_sum[2])
print(cost_sum[3])
print(cost_sum[4])
print(cost_sum[5])
print(cost_sum[6])
print(cost_sum[7])
print(cost_sum[4])
print(cost_sum[4])
print(cost_sum[1])
print(cost_sum[6])
print(cost_sum[3])
cost_sum <- summary(covid_healthcarecosts$avg_cost_2022)
cases2021_sum <- summary(covid_healthcarecosts$cases_per_100k_2021)
cases2022_sum <- summary(covid_healthcarecosts$cases_per_100k_2022)
maprankcovidcases <- mapcovidcases %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"),
rank2022case=rank(-cases_per_100k_2022, ties.method="first"),
rank2022cost=rank(-avg_cost_2022, ties.method="first")) %>%
select(-c("avg_cost_2022", "avg_daily_cases_2021", "avg_daily_cases_2022", "popestimate2021", "popestimate2022", "cases_per_100k_2021", "cases_per_100k_2022"))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr, stringr)
