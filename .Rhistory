knitr::opts_chunk$set(echo = TRUE)
install.packages("tidyverse")
library(tidyverse)
read_csv("data/policymaptest.csv")
renv::snapshot
knitr::opts_chunk$set(echo = TRUE)
install.packages("janitor")
library(tidyverse, janitor)
avghealthcarecost2022<-read.csv("data/policymaptest.csv")
avghealthcarecost2022
rate2021<-read.csv("data/covidrate2021.csv")
rate2021
library(janitor)
covid_healthcare_costs <- left_join(avghealthcarecost2022, rate2021, by=c("GeoID", "Geography.Name","Sits.in.State")) %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
county_fips = geo_id,
avg_healthcarecost = totslf_avg,
year = time_frame,
avg_covidcases = pc_av7dy_2wk_cases,
week_start = time_frame_2) %>%
select("county","state", "county_fips", "avg_healthcarecost", "year", "avg_covidcases", "week_start") %>%
drop_na() %>%
mutate(avg_healthcarecost = as.numeric(avg_healthcarecost),
avg_covidcases = as.numeric(avg_covidcases))
covid_healthcare_costs
summary(covid_healthcare_costs$avg_healthcarecost)
summary(covid_healthcare_costs$avg_covidcases)
##install.packages("devtools")
##devtools::install_github("UrbanInstitute/urbnmapr")
##library(urbnmapr)
us_covid_healthcare_costs <- left_join(covid_healthcare_costs, counties, by = c("county_fips"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, janitor, urbnmapr)
##install.packages("devtools")
##devtools::install_github("UrbanInstitute/urbnmapr")
##library(urbnmapr)
us_covid_healthcare_costs <- left_join(covid_healthcare_costs, counties, by = c("county_fips"))
install.packages("devtools")
devtools::install_github("UrbanInstitute/urbnmapr")
library(urbnmapr)
us_covid_healthcare_costs <- left_join(covid_healthcare_costs, counties, by = c("county_fips"))
pacman::p_load(tidyverse, janitor, urbnmapr)
us_covid_healthcare_costs %>%
ggplot(aes(long, lat, group = group, fill = avg_healthcarecost)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
us_covid_healthcare_costs %>%
ggplot(aes(long, lat, group = group, fill = avg_covidcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
View(rate2021)
covid_healthcare_costs <- left_join(avghealthcarecost2022, rate2021, by=c("GeoID", "Geography.Name","Sits.in.State")) %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
county_fips = geo_id,
avg_healthcarecost = totslf_avg,
year = time_frame,
avg_covidcases = pc_av7dy_2wk_cases,
time_frame = time_frame_2) %>%
select("county","state", "county_fips", "avg_healthcarecost", "year", "avg_covidcases", "time_frame") %>%
drop_na() %>%
mutate(avg_healthcarecost = as.numeric(avg_healthcarecost),
avg_covidcases = as.numeric(avg_covidcases))
covid_healthcare_costs
summary(covid_healthcare_costs$avg_healthcarecost)
summary(covid_healthcare_costs$avg_covidcases)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
library(tidyverse, janitor, urbnmapr)
avghealthcarecost2022<-read.csv("data/policymaptest.csv")
head(avghealthcarecost2022)
rate2021<-read.csv("data/covidrate2021.csv")
head(rate2021)
cases2021<-read.csv("data/us-counties-2021.csv")
head(cases2021)
cases2022<-read.csv("data/us-counties-2022.csv")
cases2022
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases")
head(annualcases2021)
View(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum("2021-01-01":"2021-12-31"))
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(`2021-01-01`:`2021-12-31`))
head(annualcases2021)
annualcases2021 <- cases2021 %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(`2021-01-01`:`2021-12-31`))
# select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = Rowsums(`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = rowSums(`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(`2021-01-01`:`2021-12-31`))) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(2021-01-01:2021-12-31))) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(`2021-01-01`:`2021-12-31`))) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(`2021-01-01`:`2021-12-31`), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
View(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(`2021-01-01`:`2021-12-31`), na.rm = F)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
# (`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(starts_with("2021")))) %>%
# (`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
# (`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
# (`2021-01-01`:`2021-12-31`)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
View(cases2021)
annualcases2021 <- cases2021 %>%
# select("date", "county", "state", "fips", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases")
# rowwise() %>%
# mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
# select("county", "state", "fips", "annualcases")
head(annualcases2021)
annualcases2021 <- cases2021 %>%
pivot_wider(names_from = "date",
values_from = "cases")
rowwise() %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
View(cases2021)
annualcases2021 <- cases2021 %>%
select(-"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2021)
View(cases2022)
annualcases2022 <- cases2022 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases = sum(c_across(starts_with("2022")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
head(annualcases2022)
View(avghealthcarecost2022)
View(annualcases2021)
covid_cases <- annualcases2021 %>%
left_join(annualcases2022, by = "fips") %>%
head()
View(covid_cases)
annualcases2021 <- cases2021 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases_2021 = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases")
annualcases2021 <- cases2021 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases_2021 = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases_2021")
head(annualcases2021)
annualcases2022 <- cases2022 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases_2022 = sum(c_across(starts_with("2022")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases_2022")
head(annualcases2022)
covid_cases <- annualcases2021 %>%
left_join(annualcases2022, by = c("county", "state", "fips")) %>%
head()
View(covid_cases)
covid_cases <- annualcases2021 %>%
left_join(annualcases2022, by = c("county", "state", "fips")) %>%
left_join(avghealthcarecost2022, by = c("fips" = "GeoID"))
covid_cases <- annualcases2021 %>%
left_join(annualcases2022, by = c("county", "state", "fips")) %>%
left_join(avghealthcarecost2022, by = c(`fips` = `GeoID`))
avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = geo_id,
avg_cost = totslf_avg,
year = time_frame)
head(avghealthcarecost2022)
View(avghealthcarecost2022)
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = as.numeric(geo_id),
avg_cost = totslf_avg,
year = time_frame) %>%
select("county","state", "fips", "avg_cost", "year")
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = as.numeric(GeoID),
avg_cost = totslf_avg,
year = time_frame) %>%
select("county","state", "fips", "avg_cost", "year")
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names()
# rename(
#   county = geo_id_name,
#   state = sitsin_state,
#   fips = as.numeric(GeoID),
#   avg_cost = totslf_avg,
#   year = time_frame) %>%
# select("county","state", "fips", "avg_cost", "year")
head(healthcare_2022)
View(healthcare_2022)
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = as.numeric(geo_id),
avg_cost = totslf_avg,
year = time_frame) %>%
select("county","state", "fips", "avg_cost", "year")
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = geo_id,
avg_cost = totslf_avg,
year = time_frame) %>%
select("county","state", "fips", "avg_cost", "year")
head(healthcare_2022)
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = geo_id,
avg_cost = totslf_avg,
year = time_frame) %>%
mutate(fips = as.numeric(fips)) %>%
select("county","state", "fips", "avg_cost", "year")
head(healthcare_2022)
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = geo_id,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(fips)) %>%
select("county","state", "fips", "avg_cost_2022")
head(healthcare_2022)
covid_cases <- annualcases2021 %>%
left_join(annualcases2022, healthcare_2022, by = c("county", "state", "fips"))
head(covid_cases)
View(covid_cases)
covid_cases <- left_join(annualcases2021, annualcases2022, healthcare_2022, by = c("county", "state", "fips"))
head(covid_cases)
View(covid_cases)
View(covid_cases)
covid_cases <- left_join(healthcare_2022, annualcases2021, annualcases2022, by = c("county", "state", "fips"))
head(covid_cases)
View(covid_cases)
covid_cases <- healthcare_2022 %>%
left_join(annualcases2021, annualcases2022, by = c("county", "state", "fips"))
head(covid_cases)
View(covid_cases)
View(healthcare_2022)
View(annualcases2021)
covid_cases <- healthcare_2022 %>%
left_join(annualcases2021, annualcases2022, by = c("county", "fips"))
head(covid_cases)
state_keys <- tibble(state = state.name, ab = state.abb) %>%
rename(state_name = state)
state_keys
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
rename(
county = geo_id_name,
state = sitsin_state,
fips = geo_id,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(fips)) %>%
select("county","state", "fips", "avg_cost_2022") %>%
left_join(state_keys, by = c("state" = "ab")) %>%
select(-state)
head(healthcare_2022)
View(healthcare_2022)
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
left_join(state_keys, by = c("sitsin_state" = "ab")) %>%
select(-state) %>%
rename(
county = geo_id_name,
state = state_name,
fips = geo_id,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(fips)) %>%
select("county","state", "fips", "avg_cost_2022")
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
left_join(state_keys, by = c("sitsin_state" = "ab")) %>%
rename(
county = geo_id_name,
state = state_name,
fips = geo_id,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(fips)) %>%
select("county","state", "fips", "avg_cost_2022")
head(healthcare_2022)
covid_cases <- healthcare_2022 %>%
left_join(annualcases2021, annualcases2022, by = c("county","state", "fips"))
head(covid_cases)
View(healthcare_2022)
View(covid_cases)
covid_cases <- healthcare_2022 %>%
left_join(annualcases2021, by = c("county","state", "fips")) %>%
left_join(annualcases2022, by = c("county","state", "fips"))
head(covid_cases)
View(covid_cases)
covid_costs <- healthcare_2022 %>%
left_join(annualcases2021, by = c("county","state", "fips")) %>%
left_join(annualcases2022, by = c("county","state", "fips"))
head(covid_costs)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
state_keys <- tibble(state = state.name, ab = state.abb) %>%
rename(state_name = state)
state_keys
library(tidyverse, janitor, urbnmapr)
avghealthcarecost2022<-read.csv("data/policymaptest.csv")
head(avghealthcarecost2022)
# Possibly Remove
rate2021<-read.csv("data/covidrate2021.csv")
head(rate2021)
# New stuff added
cases2021<-read.csv("data/us-counties-2021.csv")
head(cases2021)
cases2022<-read.csv("data/us-counties-2022.csv")
cases2022
annualcases2021 <- cases2021 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases_2021 = sum(c_across(starts_with("2021")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases_2021")
head(annualcases2021)
annualcases2022 <- cases2022 %>%
select(!"deaths") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
rowwise() %>%
mutate(annualcases_2022 = sum(c_across(starts_with("2022")), na.rm = T)) %>%
select("county", "state", "fips", "annualcases_2022")
head(annualcases2022)
healthcare_2022 <- avghealthcarecost2022 %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
left_join(state_keys, by = c("sitsin_state" = "ab")) %>%
rename(
county = geo_id_name,
state = state_name,
fips = geo_id,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(fips)) %>%
select("county","state", "fips", "avg_cost_2022")
head(healthcare_2022)
covid_costs <- healthcare_2022 %>%
left_join(annualcases2021, by = c("county","state", "fips")) %>%
left_join(annualcases2022, by = c("county","state", "fips"))
head(covid_costs)
View(covid_costs)
