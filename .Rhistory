map_costs_cases %>%
filter(state=="Georgia") %>%
ggplot(aes(long, lat, group = group, fill = annualcases_2022)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
# ## If you want to use new data, the dataset is called covid_costs - Emma
us_covid_healthcare_costs <- left_join(covid_healthcare_costs, counties, by = c("county_fips"))
us_covid_healthcare_costs %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = avg_healthcarecost)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
us_covid_healthcare_costs %>%
filter(state=="GA") %>%
ggplot(aes(long, lat, group = group, fill = avg_covidcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T))
standard1<- us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
standard1<- us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
boxplot(standard1$newcosts)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
standard1<- us_covid_healthcare_costs %>%
filter(state=="GA") %>%
mutate(mediancases=median(avg_covidcases, na.rm=T)) %>%
mutate(newcases=(avg_covidcases-mediancases)*100/mediancases) %>%
mutate(mediancostsstate=median(avg_healthcarecost, na.rm=T)) %>%
mutate(newcosts=(avg_healthcarecost-mediancostsstate)*100/mediancostsstate)
summary(standard1$newcases)
summary(standard1$newcosts)
boxplot(standard1$newcases)
boxplot(standard1$newcosts)
#
#
#
# Q1case1=quantile(standard1$newcases, .25, na.rm=T)
# Q3case1=quantile(standard1$newcases, .75, na.rm=T)
# IQR4=Q3case1-Q1case1
# Q1cost1=quantile(standard1$newcosts, .25, na.rm=T)
# Q3cost1=quantile(standard1$newcosts, .75, na.rm=T)
# IQR5=Q3cost1-Q1cost1
#
# standard_costs_cleaned <- standard1 %>%
#   mutate(is_outlier=newcases<(Q1case1-1.5*IQR4) |
#            newcases>(Q3case1+1.5*IQR4)|
#            newcosts<(Q1cost1-1.5*IQR5)|
#            newcosts>(Q3cost1+1.5*IQR5)) %>%
#   filter(!is_outlier)
#
# summary(standard_costs_cleaned$newcases)
# summary(standard_costs_cleaned$newcosts)
#
# boxplot(standard_costs_cleaned$newcases)
standard1 %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard1 %>%
ggplot(aes(long, lat, group = group, fill = newcases)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
standard1 %>%
ggplot(aes(long, lat, group = group, fill = newcosts)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
# standard_costs_cleaned %>%
#     ggplot(aes(long, lat, group = group, fill = newcases)) +
#   geom_polygon(color=NA) +
#   scale_fill_gradientn(colors=rev(rainbow(7)))+
#   coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
#   theme_void() +
#   labs(fill = "")
#
# standard_costs_cleaned %>%
#     ggplot(aes(long, lat, group = group, fill = newcosts)) +
#   geom_polygon(color=NA) +
#   scale_fill_gradientn(colors=rev(rainbow(7)))+
#   coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
#   theme_void() +
#   labs(fill = "")
#install.packages("tidyverse")
#install.packages("janitor")
#install.packages("pacman")
#install.packages("devtools")
#library(devtools)
#devtools::install_github("UrbanInstitute/urbnmapr")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
pacman::p_load(tidyverse, janitor, urbnmapr)
library(tidyverse, janitor, urbnmapr)
avghealthcare_2022 <- read.csv("./data/healthcarecosts2022.csv") %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
filter(sitsin_state == "GA") %>%
rename(county = geo_id_name,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(geo_id)) %>%
select("county", "fips", "avg_cost_2022")
head(avghealthcare_2022)
county_pop <- read.csv("./data/population.csv") %>%
clean_names() %>%
filter(stname == "Georgia" & ctyname != "Georgia") %>%
mutate(county = sprintf("%03d", county)) %>%
unite(col = "fips", state, county, sep = "") %>%
mutate(county = str_remove(ctyname, " County"),
fips = as.numeric(fips)) %>%
select("fips", "county", "popestimate2021", "popestimate2022")
head(county_pop)
covidcases2021_new <- read.csv("./data/us-counties-2021.csv") %>%
filter(state == "Georgia" & county != "Unknown") %>%
select("date", "geoid", "county", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(fips = as.numeric(str_remove(geoid, "USA-"))) %>%
select(-"geoid")
head(covidcases2021_new)
covidcases2022_new <- read.csv("./data/us-counties-2022.csv") %>%
filter(state == "Georgia" & county != "Unknown") %>%
select("date", "geoid", "county", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(fips = as.numeric(str_remove(geoid, "USA-"))) %>%
select(-"geoid")
head(covidcases2022_new)
covid_cases_new <- covidcases2021_new %>%
left_join(covidcases2022_new, by = c("county", "fips"))
covid_pop <- covid_cases_new %>%
left_join(county_pop, by = c("county", "fips")) %>%
rowwise() %>%
mutate(avg_daily_cases_2021 = sum(c_across(starts_with("2021")), na.rm = T) / 365,
avg_daily_cases_2022 = sum(c_across(starts_with("2022")), na.rm = T) / 365) %>%
mutate(cases_per_100k_2021 = (avg_daily_cases_2021/popestimate2021)*100000,
cases_per_100k_2022 = (avg_daily_cases_2022/popestimate2022)*100000) %>%
select("county", "fips", "avg_daily_cases_2021", "avg_daily_cases_2022", "popestimate2021", "popestimate2022", "cases_per_100k_2021", "cases_per_100k_2022")
head(covid_pop)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips"))
head(covid_costs)
mapcovidcases<- left_join(covid_costs, counties, by=c("fips"="county_fips"))
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties, by=c("fips"="county_fips"))
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(5)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
county_pop
hist(covid_costs$cases_per_100k_2021)
hist(covid_costs$cases_per_100k_2022)
hist(covid_costs$avg_cost_2022)
avghealthcare_2022 <- read.csv("./data/healthcarecosts2022.csv") %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
filter(sitsin_state == "GA") %>%
rename(county = geo_id_name,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(geo_id),
avg_cost_2022=as.numeric(avg_cost_2022)) %>%
select("county", "fips", "avg_cost_2022")
head(avghealthcare_2022)
hist(covid_costs$avg_cost_2022)
covid_costs
avghealthcare_2022 <- read.csv("./data/healthcarecosts2022.csv") %>%
row_to_names(row_number = 1) %>%
clean_names() %>%
filter(sitsin_state == "GA") %>%
rename(county = geo_id_name,
avg_cost_2022 = totslf_avg) %>%
mutate(fips = as.numeric(geo_id),
avg_cost_2022=as.numeric(avg_cost_2022)) %>%
select("county", "fips", "avg_cost_2022")
head(avghealthcare_2022)
county_pop <- read.csv("./data/population.csv") %>%
clean_names() %>%
filter(stname == "Georgia" & ctyname != "Georgia") %>%
mutate(county = sprintf("%03d", county)) %>%
unite(col = "fips", state, county, sep = "") %>%
mutate(county = str_remove(ctyname, " County"),
fips = as.numeric(fips)) %>%
select("fips", "county", "popestimate2021", "popestimate2022")
head(county_pop)
covidcases2021_new <- read.csv("./data/us-counties-2021.csv") %>%
filter(state == "Georgia" & county != "Unknown") %>%
select("date", "geoid", "county", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(fips = as.numeric(str_remove(geoid, "USA-"))) %>%
select(-"geoid")
head(covidcases2021_new)
covidcases2022_new <- read.csv("./data/us-counties-2022.csv") %>%
filter(state == "Georgia" & county != "Unknown") %>%
select("date", "geoid", "county", "cases") %>%
pivot_wider(names_from = "date",
values_from = "cases") %>%
mutate(fips = as.numeric(str_remove(geoid, "USA-"))) %>%
select(-"geoid")
head(covidcases2022_new)
covid_cases_new <- covidcases2021_new %>%
left_join(covidcases2022_new, by = c("county", "fips"))
covid_pop <- covid_cases_new %>%
left_join(county_pop, by = c("county", "fips")) %>%
rowwise() %>%
mutate(avg_daily_cases_2021 = sum(c_across(starts_with("2021")), na.rm = T) / 365,
avg_daily_cases_2022 = sum(c_across(starts_with("2022")), na.rm = T) / 365) %>%
mutate(cases_per_100k_2021 = (avg_daily_cases_2021/popestimate2021)*100000,
cases_per_100k_2022 = (avg_daily_cases_2022/popestimate2022)*100000) %>%
select("county", "fips", "avg_daily_cases_2021", "avg_daily_cases_2022", "popestimate2021", "popestimate2022", "cases_per_100k_2021", "cases_per_100k_2022")
head(covid_pop)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
head(covid_costs)
avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips"))
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
head(covid_costs)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
head(covid_costs)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips"))
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
head(covid_costs)
covid_costs
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
head(covid_costs)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips"))
head(covid_costs)
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips"))
head(covid_costs)
hist(covid_costs$cases_per_100k_2021)
hist(covid_costs$cases_per_100k_2022)
hist(covid_costs$avg_cost_2022)
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips")) %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"))
mapcovidcases
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"))
head(covid_costs)
covid_costs
covid_costs <- avghealthcare_2022 %>%
left_join(covid_pop, by = c("county", "fips")) %>%
mutate(rank2021case=rank(-cases_per_100k_2021, ties.method="first"),
rank2022case=rank(-cases_per_100k_2022, ties.method="first"),
rank2022cost=rank(-avg_cost_2022, ties.method="first"))
covid_costs
summary(covid_costs$rank2021case)
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2021case)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2022case)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = rank2022cost)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = rank2022cost)) +
geom_polygon(color=NA) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = rank2022cost)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
counties1<-counties %>%
mutate(fips=as.numeric(county_fips))
mapcovidcases<- left_join(covid_costs, counties1, by=c("fips"))
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2021case)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = rank2022case)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = rank2022cost)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
ggplot(aes(long, lat, group = group, fill = cases_per_100k_2021)) +
geom_polygon() +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
mapcovidcases %>%
mutate(avg_cost_2022=as.numeric(avg_cost_2022)) %>%
ggplot(aes(long, lat, group = group, fill = avg_cost_2022)) +
geom_polygon(color=NA) +
scale_fill_gradientn(colors=rev(rainbow(7)))+
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
labs(fill = "")
covid_cases_new %>%
left_join(county_pop, by = c("county", "fips")) %>%
rowwise()
